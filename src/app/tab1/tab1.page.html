<ion-header class="ion-no-border">
  <ion-toolbar color="primary">
    <ion-title>Mi Perfil</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="logout()" fill="clear">
        <ion-icon slot="icon-only" name="log-out-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="header-background"></div>

  <div class="profile-container" *ngIf="cliente">
    <div class="profile-header ion-text-center">
      <div class="avatar-container">
        <ion-icon name="person"></ion-icon>
      </div>
      <h2>{{ cliente.nombre }}</h2>
      <p>{{ cliente.dni }}</p>
    </div>

    <ion-card mode="md">
      <ion-card-content>
        <ion-item lines="none">
          <ion-icon name="location-outline" slot="start" color="primary"></ion-icon>
          <ion-label>
            <h3>Dirección</h3>
            <p>{{ cliente.direccion }}</p>
          </ion-label>
        </ion-item>
        <ion-item lines="none">
          <ion-icon name="phone-portrait-outline" slot="start" color="primary"></ion-icon>
          <ion-label>
            <h3>Teléfono</h3>
            <p>{{ cliente.telefono }}</p>
          </ion-label>
        </ion-item>
      </ion-card-content>
    </ion-card>

    <div class="section-header">
      <h3>Mis Facturas</h3>
      <ion-badge color="primary">{{ cliente.facturas?.length || 0 }}</ion-badge>
    </div>

    <ion-list lines="inset" mode="md">
      <ion-item *ngFor="let factura of cliente?.facturas" (click)="verFactura(factura)" button detail="true">
        <ion-icon name="receipt-outline" slot="start" color="medium"></ion-icon>
        <ion-label>
          <h2>Factura #{{ factura.id }}</h2>
          <p>{{ factura.fecha | date:'mediumDate' }}</p>
        </ion-label>
        <ion-badge slot="end" [color]="factura.esPagada ? 'success' : 'warning'" mode="md">
          {{ factura.esPagada ? 'PAGADA' : 'PENDIENTE' }}
        </ion-badge>
      </ion-item>
      <ion-item *ngIf="!cliente?.facturas || cliente?.facturas?.length === 0">
        <ion-label class="ion-text-center">No hay facturas registradas</ion-label>
      </ion-item>
    </ion-list>

    <div class="section-header">
      <h3>Mis Reservas</h3>
      <ion-badge color="secondary">{{ reservas.length }}</ion-badge>
    </div>

    <ion-list lines="inset" mode="md">
      <ion-item *ngFor="let reserva of reservas" (click)="verReserva(reserva)" button detail="true">
        <ion-icon name="calendar-outline" slot="start" color="medium"></ion-icon>
        <ion-label>
          <h2>Reserva #{{ reserva.id }}</h2>
          <p>{{ reserva.inicio | date:'shortDate' }} - {{ reserva.final | date:'shortDate' }}</p>
        </ion-label>
        <ion-badge slot="end" [color]="reserva.estado === 1 ? 'success' : (reserva.estado === 2 ? 'danger' : 'primary')" mode="md">
          {{ reserva.estado === 1 ? 'CONFIRMADA' : (reserva.estado === 2 ? 'CANCELADA' : 'SOLICITADA') }}
        </ion-badge>
      </ion-item>
      <ion-item *ngIf="reservas.length === 0">
        <ion-label class="ion-text-center">No hay reservas registradas</ion-label>
      </ion-item>
    </ion-list>
  </div>
</ion-content>
